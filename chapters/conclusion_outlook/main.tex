\chapter{Closing Remarks}
\label{ch:summary}

\dictum[Vincent Van Gogh]{%
  I dream my painting and I paint my dream. }%
\vskip 1em

This chapter summarizes the work presented in this thesis and highlights the main findings and results. Besides, we remark on the lessons learned and provide directions for future work.

\section{Summary of the Contributions}

This thesis expands our current understanding of the trusted path problem in modern computing systems and how it could be strengthened with moderns trusted execution environments or TEEs. We begin this thesis by illustrating the problem of the trusted path in modern (x86) platforms that run complex software and hardware. These entities span over millions of lines of code which results in a large attack surface. Attackers can exploit the vulnerabilities in the software and hardware to break the integrity and confidentiality property of sensitive IO data. TEEs have the potential to be a candidate for trusted path realization as TEEs minimize the software (in some scenario hardware, e.g., Intel SGX assumes DRAM to be untrusted) attack surfaces. TEEs do this by excluding the OS and hypervisors from the software TCB. However, issues such as reliance on the OS to connect with external devices and trust on first use (ToFU) property of the remote attestation make TEEs not ideal for the trusted path. Moreover, the TEEs' reliance on the OS or hypervisor to reach an external device result in static hardware and software TCB. This issue is undesirable, specifically in the context of modern data centers that host multiple VMs accessing different devices for their computations. Such issues amplify when we consider the trusted path applications can span over multiple special-purpose hardware devices outside the CPU cores, i.e., the modern disaggregated computing architecture in the data centers. 

Given this problem space, in summary, we make progress on two fundamental aspects of the trusted path and trusted computing in two following ways. \emph{First}, we understand the fundamental security properties that are critical for the integrity and confidentiality of a trust path. Along this line, we investigate how trusted small-TCB external devices can work in conjunction with modern computing platforms (with or without TEEs) to strengthen the trusted path. And \emph{second}, how to make small changes in the hardware and software architecture of modern TEEs to extend the security guarantees of TEEs from CPU cores to the external hardware devices.

\subsection{External Trusted Devices}

First, this thesis shows two systems \integrikey (Chapter~\ref{ch:integrikey}) and \integriscreen (Chapter~\ref{ch:integriscreen}) based on two new mechanisms: input signing and visual supervision, respectively, to provide user input integrity (and output integrity in the later work). Both of the proposals rely on a trusted device to ensure the integrity of the IO data. \integrikey uses a low-TCB embedded device where \integriscreen uses an off-the-shelf smartphone. In \integrikey, we also show a new form of IO manipulation attack that we call label swapping attack that swaps the label of input fields that may take overlapping input data to mislead the user. Both of these works show potential for using an external verifier device to work in conjunction with an attacker-controlled host to achieve trusted path properties. However, over time, we found that, like many other existing trusted path solutions, \integrikey and \integriscreen are not fully secure.

To further investigate these security issues with not only \integrikey and \integriscreen, but also existing proposals in trusted path, we look for fundamental security properties that are critical to ensure the integrity and confidentiality of use IO data. In \protection (Chapter~\ref{ch:protectIOn}), we propose these fundamental security properties, including a semi-formal proof. In \protection, we also provide a prototype based on a trusted embedded device that we call IOHub that works as the intermediary between the user's IO peripherals and the attacker-controlled host. \protection provides a sandboxed UI that interacts with the user that is rendered and operated by the IOHub. \protection shows how a trusted path can be enforced by an external hardware device that significantly reduces the TCB of a host platform running commodity software stack - OS, hypervisor, etc.

The thesis then continues with the idea of the external trusted devices and presents \proximitee (Chapter~\ref{ch:proximitee}) that uses a small USB connected device that we call ProximiKey to identify relay attacks. In \proximitee, we address relay attack, a long-standing problem in TEE where a malicious OS can divert all the traffic to a compromised platform that the attacker physically owns. The rerouting problem is well-known in the context of TPM. However, in this thesis, we are the first ones to understand the implication of the attack on Intel SGX remote attestation. We identify that almost all flavors of remote attestation rely on the trust on first-use (ToFU) property that makes them vulnerable to the relay attack. ProximiKey uses the distance bounding protocol to distinguish a physically connected platform (over USB) from a relayed (over a network) platform. Our rigorous experimental result shows the feasibility of such an attack where the attacker can execute the relay attack with an average round trip time of only 186 $\mu$s. \proximitee distance bounding mechanism can distinguish such an attack with a very high probability. In \proximitee, we also propose a second mechanism based on boot-time initialization and boot-time attestation to protect against an attacker with access to at least one leaked Intel SGX attestation key. We implement a prototype that shows the boot-time initialization and attestation are feasible. 


\subsection{Modification in Software/Hardware Architecture of the Platform}

Next, this thesis presents \pie (Chapter~\ref{ch:pie}), which looks into the trusted path problem from the perspective of disaggregated computing architecture. \pie proposes a new software architecture that is based on the traditional software architecture of application-driver-device. This new software architecture is based on an idea that we call a platform-wide enclave where enclaves could be CPU-bound enclaves or firmware enclaves running on the devices. CPU bounds enclaves are divided into application enclave and controller enclave based on their functionality (application logic or driver logic). The enclaves inside a platform-wide enclave communicate with each other over shared memory regions isolated from the OS and other enclaves using RISC-V's physical memory isolation or PMP. The platform-wide enclaves are fully attestable, and the attestation report includes the individual enclave's measurement, including the access control policy of the device and the setup configuration. Platform-wide enclaves have platform-awareness, i.e., they can detect changes in their components (connect or disconnect) and take appropriate action. We implement a \pie prototype that is based on a RISC-V processor with keystone TEE running on an FPGA platform and an Arduino microcontroller that emulates peripherals. We introduce small changes to the RISC-V firmware (known as the security monitor or SM), and we show that \pie is feasible.

\section{Future Work}

In this section, we provide future work in the field of the trusted path and trusted computing.

\subsection{Trusted Path in Smart Manufacturing Systems} The smart manufacturing system is one of the cornerstones of the fourth industrial revolution (Industry 4.0). Unlike traditional manufacturing systems, where the entire process is geared towards producing a single product, the smart manufacturing system is demand-driven and flexible. This is possible due to the adoption of 3-D printers, injection molding, industrial robots, and re-configurable manufacturing templates. Additionally, compared to traditional manufacturing, smart manufacturing systems are often highly automated. But despite such high automation, humans are involved intricately in the process. Such a high level of automation makes the smart manufacturing system an obvious target for the attacker to introduce fault to the manufactured items, damage equipment, harm human operators, impact the downtime of the systems, and many more. Such distributed system is one natural use-case scenario of \pie.

\subsection{Industrial HMI} Industrial human-machine interfaces (HMIs) act as the bridge between the human operator and the smart manufacturing plants. Typical HMIs are either commodity PC hardware or dedicated touch interfaces that provide rich UIs. An attacker-controlled OS or the host can easily represent wrong information on the HMI to confuse the human operators. Such attacks have already been demonstrated in StruxNet malware attacks. Moreover, the UI on the industrial HMIs is very different from the standard web-based UI we see. Such HMIs rely on color codes to relay information about a process or a safety hazard. The UI sequence is also critical as, during an emergency, the operators often need to execute a specific series of actions. There hasn't been sufficient research on the security of such HMI devices. Moreover, despite having some recommended standards on the HMIs, most well-deployed HMI devices are proprietary and do not adhere to those standards, making them ideal for exploits. 


\subsection{Authentication devices} Authentication is another important aspect of a trusted path. Recently, we have seen a sharp rise in second-factor authentication devices such as FIDO and other hardware-backed password managers. A preliminary investigation shows that many of such password managers emulate themselves as a keyboard to enter a password to the host system, in plain text, despite claiming to provide security against a malicious OS. Few of the managers require the installation of the browser plugin to provide auto-fill functionality in the browser. However, this requires trusting the browser that significantly increases the TCB of such approaches. Through study and security analysis of such devices are necessary to understand the security properties that they provide.



\section{Final Remarks}

This thesis looks at the increasing software and hardware complexity of modern computing platforms and how it affects one of the most fundamental aspects of computation - human-machine interaction. Despite a large number of existing research proposals and deployed systems, the problem of trusted paths largely remains unsolved. As shown in this thesis, a system-building way of designing the trusted path often leads to insecure systems. This we learn not only from our own system but the existing systems. This thesis provides an understanding of the trusted path problem by breaking it down into a set of fundamental security properties.
Moreover, this thesis explores the idea of hardware-assisted security where a small trusted embedded device can reinforce trusted path properties. The thesis also shows that the trivial way of integrating the trusted path into TEEs such as Intel SGX does not guarantee security as an underlying assumption (trust on the first use (ToFU) of remote attestation) can introduce relay attack. This thesis also explores the idea of introducing small changes into software hardware architecture to distribute the TEE properties from the CPU cores to heterogeneous peripherals. Hence, we can conclude that there is an increasing need to redesigning many of the existing platforms to reduce the trusted computing base significantly. This thesis also opens up avenues for future research directions of how to design \& evaluate trusted path systems and how to enable new trusted path features in TEEs.

